<?xml version="1.0" encoding="UTF-8"?>

<project name="CLV" default = "compile">
    <property name="src_dir" value ="./src"/>
    <property name="build_dir" value = "./build"/>
    <property name="data_dir" value="./data"/>
    <property name="exe_dir" value="./exe"/>

    <property name="exe_proto" value="Proto"/>

    <path id="project_classpath">
        <pathelement location="${build_dir}"/>
    </path>

    <target name="clean">
        <delete dir="${build_dir}"/>
    </target>

    <target name="compile" depends="clean">
        <mkdir dir="${build_dir}"/>
        <javac srcdir="${src_dir}" destdir="${build_dir}">
            <classpath>
                <path refid="project_classpath"/>
            </classpath>
        </javac>
    </target>

    <target name="executable_ProtoRcv" depends="compile">
        <delete file="${exe_dir}/${exe_proto}Rcv.jar"/>
        <jar destfile="${exe_dir}/${exe_proto}Rcv.jar" basedir="${build_dir}">
            <manifest>
                <attribute name="Main-Class" value="org.clav.ProtoRcv"/>
            </manifest>
        </jar>
    </target>

    <target name="executable_ProtoSnd" depends="compile">
        <delete file="${exe_dir}/${exe_proto}Snd.jar"/>
        <jar destfile="${exe_dir}/${exe_proto}Snd.jar" basedir="${build_dir}">
            <manifest>
                <attribute name="Main-Class" value="org.clav.ProtoSnd"/>
            </manifest>
        </jar>
    </target>
    <target name="executable_ProtoTCP" depends="compile">
        <delete file="${exe_dir}/${exe_proto}TCP.jar"/>
        <jar destfile="${exe_dir}/${exe_proto}TCP.jar" basedir="${build_dir}">
            <manifest>
                <attribute name="Main-Class" value="org.clav.ProtoTCP"/>
            </manifest>
        </jar>
    </target>
    <target name="executable_TestChat" depends="compile">
        <delete file="${exe_dir}/TestChat.jar"/>
        <jar destfile="${exe_dir}/TestChat.jar" basedir="${build_dir}">
            <manifest>
                <attribute name="Main-Class" value="org.clav.chat.TestChat"/>
            </manifest>
        </jar>
    </target>
    <target name="executable_ProtoMonitor" depends="compile">
        <delete file="${exe_dir}/${exe_proto}Monitor.jar"/>
        <jar destfile="${exe_dir}/${exe_proto}Monitor.jar" basedir="${build_dir}">
            <manifest>
                <attribute name="Main-Class" value="org.clav.ProtoMonitor"/>
            </manifest>
        </jar>
    </target>

    <target name="executable_Proto" depends="executable_ProtoRcv,executable_ProtoSnd,executable_ProtoTCP,executable_ProtoMonitor"/>

    <target name="tcp" depends="executable_ProtoTCP">
        <java jar="${exe_dir}/${exe_proto}TCP.jar" fork="true">
            <arg value="config.txt"/>
        </java>
    </target>

    <target name="monitor" depends="executable_ProtoMonitor">
        <java jar="${exe_dir}/${exe_proto}Monitor.jar" fork="true">
            <arg value="config.txt"/>
        </java>
    </target>


    <target name="run_only_ProtoRcv">
        <java classname="org.clav.ProtoRcv" fork="true">
            <classpath>
                <path refid="project_classpath"/>
            </classpath>
        </java>
    </target>

    <target name="push_proto" depends="compile">
        <exec executable="git">
            <arg value="add"/>
            <arg value="src/org/clav/Proto*.java"/>
        </exec>
        <exec executable="git">
            <arg value="commit"/>
            <arg value="-m"/>
            <arg value="'Automated Prototypes push from ant'"/>
        </exec>
        <exec executable="git">
            <arg value="push"/>
        </exec>
    </target>



</project>